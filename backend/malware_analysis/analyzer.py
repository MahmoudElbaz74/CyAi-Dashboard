from typing import List
import os
import yara

class MalwareAnalyzer:
    def __init__(self, rules_path: str):
        self.rules_path = rules_path
        self.rules = self.load_yara_rules()

    def load_yara_rules(self) -> yara.Rules:
        return yara.compile(filepath=self.rules_path)

    def scan_file(self, file_path: str) -> List[str]:
        matches = self.rules.match(file_path)
        return [match.rule for match in matches]

    def scan_directory(self, directory_path: str) -> dict:
        results = {}
        for root, _, files in os.walk(directory_path):
            for file in files:
                file_path = os.path.join(root, file)
                results[file_path] = self.scan_file(file_path)
        return results

# Example usage:
# analyzer = MalwareAnalyzer('path/to/yara/rules.yara')
# results = analyzer.scan_directory('path/to/scan')
# print(results)